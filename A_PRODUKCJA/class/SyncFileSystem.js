"use strict";var SyncFileSystem={requestFileSystem:function(){var e=new Promise(function(e,r){try{chrome.syncFileSystem.requestFileSystem(function(n){chrome.runtime.lastError||!n?r():e(n)})}catch(n){console.log(n),r()}});return e},getFileEntries:function(e){var r=new Promise(function(r,n){var t=e.root.createReader(),o=[],i=function c(){t.readEntries(function(e){e.length?(o=o.concat(e),c()):r(o)},function(e){console.error("Handled file error",e),r()})};i()});return r},getNotesFromEntries:function(e){var r=new Promise(function(r,n){var t=[],o=0,i=0;e&&0!==e.length?e.forEach(function(n,c){i++,/note_(\w|_)+/.test(n.name)?(o++,n.file(function(n){var c=new FileReader;c.onloadend=function(n){o--;var c=null;try{c=JSON.parse(this.result)}catch(l){c=null}null!==c&&t.push(c),i===e.length&&0===o&&r(t)},c.onerror=function(n){o--,console.error("FileReader onerror triggered: E10",n),i===e.length&&0===o&&r(t)},c.readAsText(n)})):i===e.length&&0===o&&r(t)}):r([])});return r},putNotes:function(e){var r=this;this.requestFileSystem().then(function(n){for(var t in e){var o=e[t];(function(e){var r=this;n.root.getFile("note_"+e.id,{create:!0},function(n){r.writeToFile(n,JSON.stringify(e))},function(e){console.error("fs.root.getFile",e)})}).call(r,o)}})},writeToFile:function(e,r){e.createWriter(function(e){var n=!1;e.onwriteend=function(e){n||(this.truncate(this.position),n=!0)},e.onerror=function(e){console.error("writeToFile Failed",e)};var t=new Blob([r],{type:"text/plain"});e.write(t)},function(e){console.error("createWriter Failed",e)})}};