"use strict";var notes=window.notes||[];$(function(){chrome.storage.sync.get(["allLaunch"],function(o){var n=o.allLaunch;n===!0?$("#showalways").attr("checked",!0):n===!1&&$("#showalways").attr("checked",!1)}),chrome.storage.local.get(["isStoreOpen"],function(o){console.log(o);var n=o.isStoreOpen;n?$(".storedependent").css("display","block"):$(".storedependent").css("display","none")}),notes&&notes.length&&0!==notes.length?displayNotes(notes):(console.log("GET MYSELF"),updateNotes()),$(".openall").on("click",function(){openAllNotes()}),$(".openallclose").on("click",function(){openAllNotes(function(){window.close()})}),$(document).on("click",".notecolor",function(){var o=$(this).data("note"),n=jQuery.grep(notes,function(n,e){return n.id===o});n&&n[0]&&(n=n[0],Notes.openNote(n))}),$("#showalways").on("change",function(){var o=$(this).is(":checked");chrome.storage.sync.set({allLaunch:o},function(){})}),$(".addnote").on("click",function(){chrome.runtime.sendMessage({func:"openNewNote"})}),$(".opensettings").on("click",function(){chrome.app.window.create("/options/main.html",{innerBounds:{width:800,height:600}})}),$(".openstore").on("click",function(){chrome.app.window.create("/store/purchase.html",{innerBounds:{width:800,height:600}})}),$(".opendonate").on("click",function(){})});var displayNotes=function(o){var n=$("#noteslist").empty();for(var e in o){var t=o[e];t.removed||n.append('<li><table><tr><td><span class="notecolor" data-note="'+t.id+'" style="background-color:'+t.color+';"></span></td><td class="notecontent" style="font-family:'+t.fontfamily+'"><div>'+t.textarea+'</div></td><td><span class="openbutton" data-note="'+t.id+'" style="background-color:'+t.color+';">Open</span></td></tr></li>')}},openAllNotes=function(o){var n=function(){e--,0===e&&"function"==typeof o&&o()},e=0;console.log("NOTES",notes);for(var t in notes){var s=notes[t];Note.isRemoved(s)||(e++,Notes.openNote(s).then(function(){n()})["catch"](function(o){n()}))}},updateNotes=function(o){o&&o.length>0?(notes=o,displayNotes(o)):IndexedDB.getNotes().then(function(o){var n=!1,e=!0,t=!1,s=void 0;try{for(var c,a=function(){var o=c.value,e=jQuery.grep(notes,function(n,e){return n.id===o.id});return e&&(Note.isContentTheSame(o,e)||o.removed!==o.removed)?(n=!0,"break"):void 0},i=o[Symbol.iterator]();!(e=(c=i.next()).done);e=!0){var r=a();if("break"===r)break}}catch(l){t=!0,s=l}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw s}}notes=o,n&&displayNotes(o)})};